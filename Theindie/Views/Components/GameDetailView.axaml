<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:models="using:Theindie.Models"
             x:DataType="models:GameInfo"
             x:Class="Theindie.Views.Components.GameDetailView"
             RenderTransformOrigin="50%,50%"> <UserControl.RenderTransform>
        <TransformGroup>
            <ScaleTransform/>
            <TranslateTransform/>
        </TransformGroup>
    </UserControl.RenderTransform>

    <UserControl.Styles>
        <Style Selector="UserControl[IsVisible=True]">
            <Style.Animations>
                <Animation Duration="0:0:0.35" Easing="CubicEaseOut" FillMode="Forward">
                    <KeyFrame KeyTime="0:0:0">
                        <Setter Property="Opacity" Value="0"/>
                        <Setter Property="ScaleTransform.ScaleX" Value="0.95"/>
                        <Setter Property="ScaleTransform.ScaleY" Value="0.95"/>
                        <Setter Property="TranslateTransform.Y" Value="20"/>
                    </KeyFrame>
                    <KeyFrame KeyTime="0:0:0.35">
                        <Setter Property="Opacity" Value="1"/>
                        <Setter Property="ScaleTransform.ScaleX" Value="1"/>
                        <Setter Property="ScaleTransform.ScaleY" Value="1"/>
                        <Setter Property="TranslateTransform.Y" Value="0"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>

        <Style Selector="StackPanel.AnimEntry">
            <Style.Animations>
                <Animation Duration="0:0:0.6" Easing="CubicEaseOut" FillMode="Forward">
                    <KeyFrame KeyTime="0:0:0"><Setter Property="Opacity" Value="0"/><Setter Property="TranslateTransform.Y" Value="50"/></KeyFrame>
                    <KeyFrame KeyTime="0:0:0.6"><Setter Property="Opacity" Value="1"/><Setter Property="TranslateTransform.Y" Value="0"/></KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
        
        <Style Selector="Grid.InfoRow"><Setter Property="Margin" Value="0,4"/></Style>
        <Style Selector="Grid.InfoRow PathIcon"><Setter Property="Foreground" Value="#666"/><Setter Property="Width" Value="16"/><Setter Property="Height" Value="16"/><Setter Property="VerticalAlignment" Value="Center"/></Style>
        <Style Selector="Grid.InfoRow TextBlock.Label"><Setter Property="Foreground" Value="#999"/><Setter Property="FontSize" Value="14"/><Setter Property="VerticalAlignment" Value="Center"/><Setter Property="FontWeight" Value="SemiBold"/></Style>
        <Style Selector="Grid.InfoRow TextBlock.Value"><Setter Property="Foreground" Value="White"/><Setter Property="FontWeight" Value="Bold"/><Setter Property="FontSize" Value="14"/><Setter Property="VerticalAlignment" Value="Center"/><Setter Property="HorizontalAlignment" Value="Right"/></Style>
        
        <Style Selector="Grid#UninstallConfirmOverlay[IsVisible=True] Border.DialogBox">
            <Style.Animations>
                <Animation Duration="0:0:0.25" Easing="BackEaseOut" FillMode="Forward">
                    <KeyFrame KeyTime="0:0:0"><Setter Property="Opacity" Value="0"/><Setter Property="ScaleTransform.ScaleX" Value="0.9"/><Setter Property="ScaleTransform.ScaleY" Value="0.9"/></KeyFrame>
                    <KeyFrame KeyTime="0:0:0.25"><Setter Property="Opacity" Value="1"/><Setter Property="ScaleTransform.ScaleX" Value="1"/><Setter Property="ScaleTransform.ScaleY" Value="1"/></KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
    </UserControl.Styles>

    <Grid Background="{StaticResource DeepBackground}">
        <Panel>
            <Image Source="{Binding ImagePath, Converter={StaticResource BitmapConverter}}" Stretch="UniformToFill" Opacity="0.4"><Image.Effect><BlurEffect Radius="80"/></Image.Effect></Image>
            <Border><Border.Background><LinearGradientBrush StartPoint="0,0" EndPoint="0,1"><GradientStop Offset="0" Color="#90050505"/><GradientStop Offset="1" Color="#050505"/></LinearGradientBrush></Border.Background></Border>
        </Panel>

        <Grid RowDefinitions="80, *" Margin="40,0">
            <Border Grid.Row="0" Background="Transparent" PointerPressed="OnRootPointerPressed"/>
            
            <Grid Grid.Row="0" VerticalAlignment="Center">
                <Button Classes="GhostBtn" Click="BackButton_Click" Foreground="White" Opacity="0.7">
                    <Button.Styles><Style Selector="Button:pointerover"><Setter Property="Opacity" Value="1"/></Style></Button.Styles>
                    <StackPanel Orientation="Horizontal" Spacing="10" VerticalAlignment="Center">
                        <PathIcon Data="{StaticResource IconBack}" Width="18"/>
                        <TextBlock Text="QUAY LẠI" FontWeight="Bold" FontSize="14" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>

            <Grid Grid.Row="1" ColumnDefinitions="*, 50, 400" Margin="0,0,0,40">
                <ScrollViewer Grid.Column="0" Padding="0,0,20,0" VerticalScrollBarVisibility="Hidden">
                    <StackPanel Classes="AnimEntry" Spacing="35">
                        <StackPanel Spacing="15">
                            <TextBlock Text="{Binding Title}" FontWeight="Black" FontSize="64" Foreground="White" LineHeight="64" TextWrapping="Wrap" LetterSpacing="-1"/>
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <Border Background="{StaticResource PrimaryRed}" CornerRadius="8" Padding="10,5"><TextBlock Text="VIỆT HÓA" FontSize="11" FontWeight="Bold" Foreground="White"/></Border>
                                <Border Background="#20FFFFFF" CornerRadius="4" Padding="12,5"><TextBlock Text="{Binding Tags}" FontSize="13" Foreground="#DDD"/></Border>
                                <Border Background="#20FFFFFF" CornerRadius="4" Padding="12,5"><TextBlock Text="⭐ 4.9/5" FontSize="13" Foreground="#FFD700" FontWeight="Bold"/></Border>
                            </StackPanel>
                        </StackPanel>

                        <Border Height="420" CornerRadius="16" Background="Black" BorderBrush="#30FFFFFF" BorderThickness="1" ClipToBounds="True" BoxShadow="0 10 40 0 #50000000">
                            <Panel>
                                <Image Source="{Binding ImagePath, Converter={StaticResource BitmapConverter}}" Stretch="UniformToFill" Opacity="0.6"/>
                                <Border Width="80" Height="80" CornerRadius="40" Background="#80000000" BorderBrush="{StaticResource PrimaryRed}" BorderThickness="2"><PathIcon Data="{StaticResource IconPlay}" Width="30" Height="30" Foreground="White" Margin="4,0,0,0"/></Border>
                            </Panel>
                        </Border>

                        <StackPanel Spacing="15">
                            <TextBlock Text="GIỚI THIỆU GAME" FontWeight="Bold" FontSize="20" Foreground="White" LetterSpacing="1"/>
                            <TextBlock Text="{Binding Description}" Foreground="#CCC" FontSize="16" LineHeight="28" TextWrapping="Wrap"/>
                        </StackPanel>
                        <Panel Height="50"/> 
                    </StackPanel>
                </ScrollViewer>

                <Border Grid.Column="2" Background="#141414" CornerRadius="16" BorderBrush="{StaticResource GlassBorder}" BorderThickness="1" Padding="30" VerticalAlignment="Top" BoxShadow="0 10 30 0 #50000000">
                    <StackPanel Spacing="30">
                        <Border CornerRadius="12" ClipToBounds="True" Height="260" BoxShadow="0 10 30 0 #50000000" BorderBrush="{StaticResource GlassBorder}" BorderThickness="1">
                            <Image Source="{Binding ImagePath, Converter={StaticResource BitmapConverter}}" Stretch="UniformToFill"/>
                        </Border>

                        <StackPanel Spacing="20">
                            <TextBlock Text="THÔNG TIN CHI TIẾT" FontWeight="Black" Foreground="#666" FontSize="12" LetterSpacing="1"/>
                            <StackPanel Spacing="18">
                                <Grid Classes="InfoRow" ColumnDefinitions="Auto, *">
                                    <StackPanel Orientation="Horizontal" Spacing="12"><PathIcon Data="{StaticResource IconTag}"/><TextBlock Classes="Label" Text="Phiên bản"/></StackPanel>
                                    <TextBlock Classes="Value" Grid.Column="1" Text="{Binding Version}"/>
                                </Grid>
                                <Separator Background="#15FFFFFF"/>
                                <Grid Classes="InfoRow" ColumnDefinitions="Auto, *">
                                    <StackPanel Orientation="Horizontal" Spacing="12"><PathIcon Data="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M15,18V13H11V18H15Z" Width="16"/><TextBlock Classes="Label" Text="Dung lượng"/></StackPanel>
                                    <TextBlock Classes="Value" Grid.Column="1" Text="{Binding Size}"/>
                                </Grid>
                                <Separator Background="#15FFFFFF"/>
                                <Grid Classes="InfoRow" ColumnDefinitions="Auto, *">
                                    <StackPanel Orientation="Horizontal" Spacing="12"><PathIcon Data="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z" Width="16"/><TextBlock Classes="Label" Text="Cập nhật"/></StackPanel>
                                    <TextBlock Classes="Value" Grid.Column="1" Text="{Binding UpdateDate}"/>
                                </Grid>
                            </StackPanel>
                        </StackPanel>

                        <Panel>
                            <Button IsVisible="{Binding !IsInstalled}" Classes="Primary" Height="60" HorizontalAlignment="Stretch" Click="InstallButton_Click">
                                <StackPanel Orientation="Horizontal" Spacing="15" VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <PathIcon Data="{StaticResource IconInstall}" Width="24" Height="24"/>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="CÀI ĐẶT NGAY" FontSize="16" FontWeight="Black"/>
                                        <TextBlock Text="Phiên bản Việt Hóa mới nhất" FontSize="12" Opacity="0.8"/>
                                    </StackPanel>
                                </StackPanel>
                            </Button>

                            <Button IsVisible="{Binding IsInstalled}" Background="#25FFFFFF" BorderBrush="#E81123" BorderThickness="2" CornerRadius="8" Height="60" HorizontalAlignment="Stretch" Click="UninstallButton_Click">
                                <Button.Styles><Style Selector="Button:pointerover /template/ ContentPresenter"><Setter Property="Background" Value="#20E81123"/><Setter Property="BorderBrush" Value="#FF1F2F"/></Style></Button.Styles>
                                <StackPanel Orientation="Horizontal" Spacing="15" VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <PathIcon Data="{StaticResource IconUninstall}" Width="24" Height="24" Foreground="#E81123"/>
                                    <TextBlock Text="GỠ CÀI ĐẶT" FontSize="16" FontWeight="Black" Foreground="#E81123" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </Panel>
                        <TextBlock Text="An toàn tuyệt đối &amp; Hoàn toàn miễn phí" HorizontalAlignment="Center" FontSize="11" Foreground="#666"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>

        <Grid Name="UninstallConfirmOverlay" IsVisible="False" Background="#CC000000">
            <Border Classes="DialogBox" Width="460" VerticalAlignment="Center" HorizontalAlignment="Center" 
                    CornerRadius="16" BorderThickness="1" BorderBrush="#30FFFFFF" Background="#1A1A1A"
                    BoxShadow="0 25 80 0 #A0000000">
                <Border Padding="30">
                    <StackPanel Spacing="30">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="15">
                            <Border Width="40" Height="40" CornerRadius="20" Background="#20E81123">
                                <TextBlock Text="⚠️" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="XÁC NHẬN GỠ CÀI ĐẶT" FontWeight="Black" FontSize="20" Foreground="#E81123" VerticalAlignment="Center" LetterSpacing="0.5"/>
                        </StackPanel>

                        <StackPanel Spacing="5">
                            <TextBlock Text="Hành động này sẽ xóa bản Việt Hóa khỏi máy tính." Foreground="#BBB" HorizontalAlignment="Center" FontSize="14"/>
                            <TextBlock TextAlignment="Center" Foreground="#AAA" TextWrapping="Wrap" FontSize="14" LineHeight="24">
                                Bạn có chắc muốn xóa <Run Text="{Binding Title}" Foreground="White" FontWeight="Bold" FontSize="15"/> không?
                            </TextBlock>
                        </StackPanel>

                        <Grid ColumnDefinitions="*, 20, *">
                            <Button Grid.Column="0" Content="HỦY BỎ" Click="CancelUninstall_Click" 
                                    Background="Transparent" BorderThickness="1" BorderBrush="#444" CornerRadius="8" 
                                    Foreground="#CCC" Height="45" FontWeight="Bold" HorizontalAlignment="Stretch"/>
                            
                            <Button Grid.Column="2" Click="ConfirmUninstall_Click" 
                                    Background="#E81123" CornerRadius="8" Height="45" HorizontalAlignment="Stretch" BorderThickness="0">
                                <Button.Styles><Style Selector="Button:pointerover /template/ ContentPresenter"><Setter Property="Background" Value="#C40D1C"/><Setter Property="BoxShadow" Value="0 0 15 0 #40E81123"/></Style></Button.Styles>
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <PathIcon Data="{StaticResource IconCheck}" Width="14" Foreground="White"/>
                                    <TextBlock Text="ĐỒNG Ý GỠ" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </StackPanel>
                </Border>
            </Border>
        </Grid>
    </Grid>
</UserControl>